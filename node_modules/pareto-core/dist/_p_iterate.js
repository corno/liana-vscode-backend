"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = _p_iterate;
function _p_iterate($, assign) {
    const raw = $.__get_raw_copy();
    const length = raw.length;
    let position = 0;
    return assign({
        look: () => {
            if (position < 0 || position >= raw.length) {
                return null;
            }
            return [raw[position]];
        },
        look_ahead: (offset) => {
            if (position + offset < 0 || position + offset >= raw.length) {
                return null;
            }
            return [raw[position + offset]];
        },
        consume: (assign, abort) => {
            const current = $.__deprecated_get_item_at(position, {
                out_of_bounds: abort.no_more_tokens
            });
            position += 1;
            return assign(current, position);
        },
        discard: (assign) => {
            position += 1;
            return assign();
        },
        get_position: () => {
            return position;
        },
        assert_finished: (assign, abort) => {
            const result = assign();
            if (position < length) {
                return abort.not_finished(null);
            }
            return result;
        }
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiX3BfaXRlcmF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9fcF9pdGVyYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRUEsNkJBeURDO0FBekRELFNBQXdCLFVBQVUsQ0FDOUIsQ0FBaUIsRUFDakIsTUFBa0Q7SUFHbEQsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFBO0lBRTlCLE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUE7SUFFekIsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFBO0lBRWhCLE9BQU8sTUFBTSxDQUFDO1FBQ1YsSUFBSSxFQUFFLEdBQUcsRUFBRTtZQUNQLElBQUksUUFBUSxHQUFHLENBQUMsSUFBSSxRQUFRLElBQUksR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUN6QyxPQUFPLElBQUksQ0FBQTtZQUNmLENBQUM7WUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUE7UUFDMUIsQ0FBQztRQUNELFVBQVUsRUFBRSxDQUFDLE1BQWMsRUFBRSxFQUFFO1lBQzNCLElBQUksUUFBUSxHQUFHLE1BQU0sR0FBRyxDQUFDLElBQUksUUFBUSxHQUFHLE1BQU0sSUFBSSxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQzNELE9BQU8sSUFBSSxDQUFBO1lBQ2YsQ0FBQztZQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUE7UUFDbkMsQ0FBQztRQUNELE9BQU8sRUFBRSxDQUNMLE1BQU0sRUFDTixLQUFLLEVBQ1AsRUFBRTtZQUNBLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyx3QkFBd0IsQ0FDdEMsUUFBUSxFQUNSO2dCQUNJLGFBQWEsRUFBRSxLQUFLLENBQUMsY0FBYzthQUN0QyxDQUNKLENBQUE7WUFDRCxRQUFRLElBQUksQ0FBQyxDQUFBO1lBQ2IsT0FBTyxNQUFNLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFBO1FBQ3BDLENBQUM7UUFDRCxPQUFPLEVBQUUsQ0FDTCxNQUFlLEVBQ2pCLEVBQUU7WUFDQSxRQUFRLElBQUksQ0FBQyxDQUFBO1lBQ2IsT0FBTyxNQUFNLEVBQUUsQ0FBQTtRQUNuQixDQUFDO1FBQ0QsWUFBWSxFQUFFLEdBQUcsRUFBRTtZQUNmLE9BQU8sUUFBUSxDQUFBO1FBQ25CLENBQUM7UUFDRCxlQUFlLEVBQUUsQ0FDYixNQUFNLEVBQ04sS0FBSyxFQUNQLEVBQUU7WUFDQSxNQUFNLE1BQU0sR0FBRyxNQUFNLEVBQUUsQ0FBQTtZQUN2QixJQUFJLFFBQVEsR0FBRyxNQUFNLEVBQUUsQ0FBQztnQkFDcEIsT0FBTyxLQUFLLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFBO1lBQ25DLENBQUM7WUFDRCxPQUFPLE1BQU0sQ0FBQTtRQUNqQixDQUFDO0tBQ0osQ0FBQyxDQUFBO0FBQ04sQ0FBQyJ9