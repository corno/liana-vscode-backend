"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decide = void 0;
exports.ss = ss;
exports.au = au;
const List_1 = require("./literals/List");
/**
 * ss means 'switch state'.
 * used to make the value T the context variable ('$')
 * given a tuple of a string and a value T,
 * the function takes the value T and calls back the callback ($c)
 * notice that the string part is never used
 *
 * example:
 *
 * switch ($.state[0]) {
 *     case 'on':
 *          return ss($.state, ($) => $.value)
 *     case 'off':
 *          return ss($.state, ($) => null)
 *     default: return au($.state[0])
 * }
 */
function ss(option, $c) {
    return $c(option[1]);
}
/**
 * au means 'assert unreachable'. Used in the 'default' clause of switch statements to ensure
 * during compile time that all possible cases have been implemented
 *
 * example:
 *
 * switch (x) {
 *     case '5':
 *         return 5
 *     default: return au(x)
 * }
 *
 * @param _x
 */
function au(_x) {
    throw new Error("unreachable");
}
var decide;
(function (decide) {
    decide.boolean = (boolean_value, if_true, if_false) => boolean_value
        ? if_true()
        : if_false();
    decide.dictionary = (dictionary) => {
        return {
            has_entries: (if_true, if_not_true) => dictionary.__get_number_of_entries() !== 0
                ? if_true(dictionary)
                : if_not_true(),
            has_single_entry: (if_true, if_multiple, if_none) => {
                return decide.list(dictionary.__to_list(($, id) => ({ 'id': id, 'value': $ }))).has_single_item((item) => if_true(item.value, item.id), () => if_multiple(dictionary), if_none);
            }
        };
    };
    decide.list = (list) => {
        return {
            has_first_item: (if_true, if_not_true) => list.__deprecated_get_possible_item_at(0).__decide(($) => if_true($, new List_1.List_Class(list.__get_raw_copy().slice(1))), () => if_not_true()),
            has_items: (if_true, if_not_true) => list.__get_number_of_items() !== 0
                ? if_true(list)
                : if_not_true(),
            has_last_item: (if_true, if_not_true) => list.__deprecated_get_possible_item_at(list.__get_number_of_items() - 1).__decide(($) => if_true($, new List_1.List_Class(list.__get_raw_copy().slice(0, -1))), () => if_not_true()),
            has_match: (test, if_no_match) => {
                const raw = list.__get_raw_copy();
                for (let i = 0; i < raw.length; i++) {
                    const item = raw[i];
                    const result = test(item).__get_raw();
                    if (result !== null) {
                        return result[0];
                    }
                }
                return if_no_match();
            },
            has_single_item: (if_true, if_multiple, if_none) => {
                return list.__get_number_of_items() > 2
                    ? if_multiple(list)
                    : list.__deprecated_get_possible_item_at(0).__decide(($) => if_true($), () => if_none());
            },
        };
    };
    decide.optional = (optional, if_set, if_not_set) => optional.__decide(if_set, if_not_set);
    decide.state = (state, assign) => {
        return assign(state);
    };
    decide.text = (text, assign) => {
        return assign(text);
    };
})(decide || (exports.decide = decide = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVjaWRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL19faW50ZXJuYWxzL3N5bmMvYXNzaWduL2RlY2lkZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUF1QkEsZ0JBSUM7QUFnQkQsZ0JBSUM7QUE5Q0QsMENBQTRDO0FBSzVDOzs7Ozs7Ozs7Ozs7Ozs7O0dBZ0JHO0FBQ0gsU0FBZ0IsRUFBRSxDQUNkLE1BQWlCLEVBQ2pCLEVBQWdCO0lBQ2hCLE9BQU8sRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3hCLENBQUM7QUFFRDs7Ozs7Ozs7Ozs7OztHQWFHO0FBQ0gsU0FBZ0IsRUFBRSxDQUNkLEVBQVM7SUFFVCxNQUFNLElBQUksS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBQ2xDLENBQUM7QUFFRCxJQUFpQixNQUFNLENBd0h0QjtBQXhIRCxXQUFpQixNQUFNO0lBRU4sY0FBTyxHQUFHLENBQ25CLGFBQXNCLEVBQ3RCLE9BQWlCLEVBQ2pCLFFBQWtCLEVBQ2hCLEVBQUUsQ0FBQyxhQUFhO1FBQ2QsQ0FBQyxDQUFDLE9BQU8sRUFBRTtRQUNYLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtJQUlQLGlCQUFVLEdBQUcsQ0FDdEIsVUFBNkIsRUFDL0IsRUFBRTtRQUNBLE9BQU87WUFFSCxXQUFXLEVBQUUsQ0FDVCxPQUFxQyxFQUNyQyxXQUFxQixFQUNuQixFQUFFLENBQUMsVUFBVSxDQUFDLHVCQUF1QixFQUFFLEtBQUssQ0FBQztnQkFDM0MsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7Z0JBQ3JCLENBQUMsQ0FBQyxXQUFXLEVBQUU7WUFFdkIsZ0JBQWdCLEVBQUUsQ0FDZCxPQUFpQyxFQUNqQyxXQUF5QyxFQUN6QyxPQUFpQixFQUNmLEVBQUU7Z0JBQ0osT0FBTyxPQUFBLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFB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